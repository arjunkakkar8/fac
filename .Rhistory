geom_density(aes(x=`2005`))+geom_density(aes(x=`2006`))+
geom_density(aes(x=`2007`))+geom_density(aes(x=`2008`))+
geom_density(aes(x=`2009`))+geom_density(aes(x=`2010`))+
geom_density(aes(x=`2011`))+geom_density(aes(x=`2012`))+
geom_density(aes(x=`2013`))+geom_density(aes(x=`2014`))
hist(dat$`2001`)
par(mfrow=c(4,1))
hist(dat$`2001`)
par(mfrow=c(3,1))
hist(dat$`2001`)
par(mfrow=c(3,2))
hist(dat$`2001`)
par(mfrow=c(7,2))
hist(dat$`2001`)
par(mfrow=c(2,7))
hist(dat$`2001`)
par(mfrow=c(4,4))
hist(dat$`2001`)
par(mfrow=c(3,3))
hist(dat$`2001`)
hist(dat$`2001`, main="",xlab="")
par(mfrow=c(3,3))
hist(dat$`2001`, main="",xlab="")
hist(dat$`2001`, main="2001",xlab="")
par(mfrow=c(3,3))
hist(dat$`2001`, main="2001",xlab="")
par(mfrow=c(4,3))
hist(dat$`2001`, main="2001",xlab="")
par(mfrow=c(3,4))
hist(dat$`2001`, main="2001",xlab="")
par(mfrow=c(3,4))
hist(dat$`2001`, main="2001",xlab="", ylab="")
hist(dat$`2002`, main="2002",xlab="", ylab="")
hist(dat$`2003`, main="2003",xlab="", ylab="")
hist(dat$`2004`, main="2004",xlab="", ylab="")
hist(dat$`2005`, main="2005",xlab="", ylab="")
hist(dat$`2005`, main="2005",xlab="", ylab="Frequency of Ages")
par(mfrow=c(3,4))
hist(dat$`2001`, main="2001",xlab="", ylab="")
hist(dat$`2002`, main="2002",xlab="", ylab="")
hist(dat$`2003`, main="2003",xlab="", ylab="")
hist(dat$`2004`, main="2004",xlab="", ylab="")
hist(dat$`2005`, main="2005",xlab="", ylab="Frequency of Ages")
hist(dat$`2006`, main="2006",xlab="", ylab="")
hist(dat$`2007`, main="2007",xlab="", ylab="")
hist(dat$`2008`, main="2008",xlab="", ylab="")
hist(dat$`2009`, main="2009",xlab="", ylab="")
hist(dat$`2010`, main="2010",xlab="", ylab="")
hist(dat$`2011`, main="2011",xlab="", ylab="")
hist(dat$`2012`, main="2012",xlab="", ylab="")
par(mfrow=c(3,4))
hist(dat$`2001`, main="2001",xlab="", ylab="")
hist(dat$`2002`, main="2002",xlab="", ylab="")
hist(dat$`2003`, main="2003",xlab="", ylab="")
hist(dat$`2004`, main="2004",xlab="", ylab="")
hist(dat$`2005`, main="2005",xlab="", ylab="Frequency of Ages")
hist(dat$`2006`, main="2006",xlab="", ylab="")
hist(dat$`2007`, main="2007",xlab="", ylab="")
hist(dat$`2009`, main="2009",xlab="", ylab="")
hist(dat$`2008`, main="2008",xlab="", ylab="")
hist(dat$`2010`, main="2010",xlab="Ages of Faculty", ylab="")
hist(dat$`2011`, main="2011",xlab="", ylab="")
hist(dat$`2012`, main="2012",xlab="", ylab="")
ggplot(dat)+geom_histogram(aes(x=`2014`))
ggplot(dat)+geom_histogram(aes(x=`2014`), binwidth = 5)
par(mfrow=c(3,4))
hist(dat$`2001`, main="2001",xlab="", ylab="")
hist(dat$`2003`, main="2003",xlab="", ylab="")
hist(dat$`2002`, main="2002",xlab="", ylab="")
hist(dat$`2004`, main="2004",xlab="", ylab="")
hist(dat$`2005`, main="2005",xlab="", ylab="Frequency of Ages")
hist(dat$`2006`, main="2006",xlab="", ylab="")
hist(dat$`2007`, main="2007",xlab="", ylab="")
hist(dat$`2009`, main="2009",xlab="", ylab="")
hist(dat$`2008`, main="2008",xlab="", ylab="")
hist(dat$`2011`, main="2011",xlab="", ylab="")
hist(dat$`2010`, main="2010",xlab="Ages of Faculty", ylab="")
hist(dat$`2012`, main="2012",xlab="", ylab="")
par(mfrow=c(1,1))
ggplot(dat)+geom_histogram(aes(x=`2014`), binwidth = 5)
ggplot(dat)+geom_histogram(aes(x=`2014`), binwidth = 5, col = "blue")
ggplot(dat)+geom_histogram(aes(x=`2014`), binwidth = 5, fill = "blue")
ggplot(dat)+geom_histogram(aes(x=`2014`), binwidth = 5, fill = "blue", alpha = 0.5)
ggplot(dat)+geom_histogram(aes(x=`2014`), binwidth = 5, fill = "orange", alpha = 0.5)
ggplot(dat)+geom_histogram(aes(x=`2014`), binwidth = 5, fill = "orange", alpha = 0.7)
ggplot(dat)+geom_histogram(aes(x=`2014`), binwidth = 5, fill = "orange", alpha = 0.7)+geom_density(aes(x=`2014`))
ggplot(dat)+geom_histogram(aes(x=`2014`), binwidth = 5, fill = "orange", alpha = 0.7)+geom_density()
ggplot(dat)+geom_density(aes(x=`2014`), binwidth = 5, fill = "orange", alpha = 0.7)+geom_density()
ggplot(dat)+geom_density(aes(x=`2014`), fill = "orange", alpha = 0.7)+geom_density()
ggplot(dat)+geom_histogram(aes(x=`2014`), binwidth = 5, fill = "orange", alpha = 0.7)+geom_density()
ggplot(dat)+geom_histogram(aes(x=`2014`), binwidth = 4, fill = "orange", alpha = 0.7)
ggplot(dat)+geom_histogram(aes(x=`2014`), binwidth = 3, fill = "orange", alpha = 0.7)
par(mfrow=c(3,4))
hist(dat$`2001`, main="2001",xlab="", ylab="", width = 3)
hist(dat$`2001`, main="2001",xlab="", ylab="", binwidth = 3)
par(mfrow=c(3,4))
hist(dat$`2001`, main="2001",xlab="", ylab="", binwidth = 3)
hist(dat$`2002`, main="2002",xlab="", ylab="")
hist(dat$`2003`, main="2003",xlab="", ylab="")
hist(dat$`2004`, main="2004",xlab="", ylab="")
hist(dat$`2001`, main="2001",xlab="", ylab="", binwidth = 1)
ggplot(dat, aes(x=`2014`))+geom_histogram(binwidth = 3, fill = "orange", alpha = 0.7)
ggplot(dat, aes(x=`2014`))+geom_histogram(binwidth = 3, fill = "orange", alpha = 0.7)+geom_density()
ggplot(dat, aes(x=`2014`))+geom_histogram(binwidth = 3, fill = "orange", alpha = 0.7)+geom_density(alpa=0.2)
ggplot(dat, aes(x=`2014`))+geom_histogram(binwidth = 3, fill = "orange", alpha = 0.7)+geom_density(alpha=0.2)
ggplot(dat, aes(x=`2014`))+geom_histogram(binwidth = 3, fill = "orange", alpha = 0.7)+geom_density(alpha=0.2, fill="#FF6666")
ggplot(dat, aes(x=`2014`))+geom_histogram(aes(y=..density,,)binwidth = 3, fill = "orange", alpha = 0.7)+geom_density(alpha=0.2, fill="#FF6666")
ggplot(dat, aes(x=`2014`))+geom_histogram(aes(y=..density..), binwidth = 3, fill = "orange", alpha = 0.7)+geom_density(alpha=0.2, fill="#FF6666")
ggplot(dat, aes(x=`2014`))+geom_histogram(aes(y=..density..), binwidth = 4, fill = "orange", alpha = 0.7)+geom_density(alpha=0.2, fill="#FF6666")
ggplot(dat, aes(x=`2014`))+geom_histogram(aes(y=..density..), binwidth = 4, fill = "orange", alpha = 0.7)+geom_density(alpha=0.4, fill="#FF6666")
ggplot(dat, aes(x=`2014`))+geom_histogram(aes(y=..density..), binwidth = 4, fill = "orange", alpha = 0.7)+geom_density(alpha=0.3, fill="#FF6666")
ggplot(dat, aes(x=`2014`))+geom_histogram(aes(y=..density..), binwidth = 4, fill = "orange", alpha = 0.7, col = "black")+geom_density(alpha=0.3, fill="#FF6666")
ggplot(dat, aes(x=`2014`))+geom_histogram(aes(y=..density..), binwidth = 4, fill = "orange", alpha = 0.7, col = "black")+geom_density(alpha=0.4, fill="#FF6666")
geom_density(alpha=0.4, fill="#FF6666")+ylab("Density")+xlab("Ages of Faculty in 2014")
geom_density(alpha=0.4, fill="#FF6666")+labs(y = "Density" x = "Ages of Faculty in 2014")
ggplot(dat, aes(x=`2014`))+geom_histogram(aes(y=..density..), binwidth = 4, fill = "orange", alpha = 0.7, col = "black")+
geom_density(alpha=0.4, fill="#FF6666")+labs(y = "Density" x = "Ages of Faculty in 2014")
ggplot(dat, aes(x=`2014`))+geom_histogram(aes(y=..density..), binwidth = 4, fill = "orange", alpha = 0.7, col = "black")+
geom_density(alpha=0.4, fill="#FF6666")+labs(y = "Density" x = "Ages of Faculty in 2014")
ggplot(dat, aes(x=`2014`))+geom_histogram(aes(y=..density..), binwidth = 4, fill = "orange", alpha = 0.7, col = "black")+
geom_density(alpha=0.4, fill="#FF6666")+labs(y = "Density", x = "Ages of Faculty in 2014")
geom_density(alpha=0.4, fill="#FF6666")+labs(y = "Density", x = "Age", title = "Estimated Ages of Williams College Faculty in 2014")
ggplot(dat, aes(x=`2014`))+geom_histogram(aes(y=..density..), binwidth = 4, fill = "orange", alpha = 0.7, col = "black")+
geom_density(alpha=0.4, fill="#FF6666")+labs(y = "Density", x = "Age", title = "Estimated Ages of Williams College Faculty in 2014")
ggplot(dat)+geom_density(aes(x=`2001`), fill="red", alpha=0.5)+geom_density(aes(x=`2002`))+
geom_density(aes(x=`2003`))+geom_density(aes(x=`2004`))+
geom_density(aes(x=`2005`))+geom_density(aes(x=`2006`))+
geom_density(aes(x=`2007`))+geom_density(aes(x=`2008`))+
geom_density(aes(x=`2009`))+geom_density(aes(x=`2010`))+
geom_density(aes(x=`2011`))+geom_density(aes(x=`2012`))+
geom_density(aes(x=`2013`))+geom_density(aes(x=`2014`))
ggplot(dat)+geom_density(aes(x=`2001`, fill="red"), alpha=0.5)+
geom_density(aes(x=`2005`, fill="green"), alpha=0.5)+
geom_density(aes(x=`2009`, fill="blue"), alpha=0.5)+
geom_density(aes(x=`2014`, fill="yellow"), alpha=0.5)
ggplot(dat)+geom_density(aes(x=`2001`, fill="2001"), alpha=0.5)+
geom_density(aes(x=`2005`, fill="2005"), alpha=0.5)+
geom_density(aes(x=`2009`, fill="2009"), alpha=0.5)+
geom_density(aes(x=`2014`, fill="2014"), alpha=0.5)+
geom_density(aes(x=`2014`, fill="2014"), alpha=0.5)
ggplot(dat)+geom_density(aes(x=`2001`, fill="2001"), alpha=0.5)+
geom_density(aes(x=`2005`, fill="2005"), alpha=0.5)+
geom_density(aes(x=`2009`, fill="2009"), alpha=0.5)+
geom_density(aes(x=`2014`, fill="2014"), alpha=0.5)
scale_color_discrete("Year")
ggplot(dat)+geom_density(aes(x=`2001`, fill="2001"), alpha=0.5)+
geom_density(aes(x=`2005`, fill="2005"), alpha=0.5)+
geom_density(aes(x=`2009`, fill="2009"), alpha=0.5)+
geom_density(aes(x=`2014`, fill="2014"), alpha=0.5)+
scale_color_discrete("Year")
ggplot(dat)+geom_density(aes(x=`2001`, fill="2001"), alpha=0.5)+
geom_density(aes(x=`2005`, fill="2005"), alpha=0.5)+
geom_density(aes(x=`2009`, fill="2009"), alpha=0.5)+
geom_density(aes(x=`2014`, fill="2014"), alpha=0.5)+
scale_color_discrete(name="Year")
ggplot(dat)+geom_density(aes(x=`2001`, fill="2001"), alpha=0.5)+
geom_density(aes(x=`2005`, fill="2005"), alpha=0.5)+
geom_density(aes(x=`2009`, fill="2009"), alpha=0.5)+
geom_density(aes(x=`2014`, fill="2014"), alpha=0.5)+
scale_color_discrete(name="Year")
scale_color_manuak(name="Year")
ggplot(dat)+geom_density(aes(x=`2001`, fill="2001"), alpha=0.5)+
geom_density(aes(x=`2005`, fill="2005"), alpha=0.5)+
geom_density(aes(x=`2009`, fill="2009"), alpha=0.5)+
geom_density(aes(x=`2014`, fill="2014"), alpha=0.5)+
scale_color_manual(name="Year")
ggplot(dat)+geom_density(aes(x=`2001`, fill="2001"), alpha=0.5)+
geom_density(aes(x=`2005`, fill="2005"), alpha=0.5)+
geom_density(aes(x=`2009`, fill="2009"), alpha=0.5)+
geom_density(aes(x=`2014`, fill="2014"), alpha=0.5)+
scale_color_manual(name="Year")+labs(x="Age", y="Density")
ggplot(dat)+geom_density(aes(x=`2001`, fill="2001"), alpha=0.5)+
geom_density(aes(x=`2005`, fill="2005"), alpha=0.5)+
geom_density(aes(x=`2009`, fill="2009"), alpha=0.5)+
geom_density(aes(x=`2014`, fill="2014"), alpha=0.5)+
scale_color_manual(name="Year")+
labs(x="Age", y="Density", title="Change in Age Distribution accross Years")
ggplot(dat)+geom_density(aes(x=`2001`, col="2001"), alpha=0.5)+geom_density(aes(x=`2002`))+
geom_density(aes(x=`2003`))+geom_density(aes(x=`2004`))+
geom_density(aes(x=`2005`))+geom_density(aes(x=`2006`))+
geom_density(aes(x=`2007`))+geom_density(aes(x=`2008`))+
geom_density(aes(x=`2009`))+geom_density(aes(x=`2010`))+
geom_density(aes(x=`2011`))+geom_density(aes(x=`2012`))+
geom_density(aes(x=`2013`))+geom_density(aes(x=`2014`))
ggplot(dat)+geom_density(aes(x=`2001`, fill="2001"), alpha=0.5)+geom_density(aes(x=`2002`))+
geom_density(aes(x=`2003`))+geom_density(aes(x=`2004`))+
geom_density(aes(x=`2005`))+geom_density(aes(x=`2006`))+
geom_density(aes(x=`2007`))+geom_density(aes(x=`2008`))+
geom_density(aes(x=`2009`))+geom_density(aes(x=`2010`))+
geom_density(aes(x=`2011`))+geom_density(aes(x=`2012`))+
geom_density(aes(x=`2013`))+geom_density(aes(x=`2014`))
ggplot(dat)+geom_density(aes(x=`2001`, fill="2001"), alpha=0.5)+geom_density(aes(x=`2002`, fill="2002"))+
geom_density(aes(x=`2003`, fill="2003"))+geom_density(aes(x=`2004`, fill="2004"))+
geom_density(aes(x=`2005`, fill="2005"))+geom_density(aes(x=`2006`, fill="2006"))+
geom_density(aes(x=`2007`, fill="2007"))+geom_density(aes(x=`2008`, fill="2008"))+
geom_density(aes(x=`2009`, fill="2009"))+geom_density(aes(x=`2010`, fill="2010"))+
geom_density(aes(x=`2011`, fill="2011"))+geom_density(aes(x=`2012`, fill="2012"))+
geom_density(aes(x=`2013`, fill="2013"))+geom_density(aes(x=`2014`, fill="2014"))
ggplot(dat)+geom_density(aes(x=`2001`, fill="2001"), alpha=0.2)+geom_density(aes(x=`2002`, fill="2002"), alpha=0.2)+
geom_density(aes(x=`2003`, fill="2003"), alpha=0.2)+geom_density(aes(x=`2004`, fill="2004"), alpha=0.2)+
geom_density(aes(x=`2005`, fill="2005"), alpha=0.2)+geom_density(aes(x=`2006`, fill="2006"), alpha=0.2)+
geom_density(aes(x=`2007`, fill="2007"), alpha=0.2)+geom_density(aes(x=`2008`, fill="2008"), alpha=0.2)+
geom_density(aes(x=`2009`, fill="2009"), alpha=0.2)+geom_density(aes(x=`2010`, fill="2010"), alpha=0.2)+
geom_density(aes(x=`2011`, fill="2011"), alpha=0.2)+geom_density(aes(x=`2012`, fill="2012"), alpha=0.2)+
geom_density(aes(x=`2013`, fill="2013"), alpha=0.2)+geom_density(aes(x=`2014`, fill="2014"), alpha=0.2)
ggplot(dat)+geom_density(aes(x=`2001`, fill="2001"), alpha=0.3)+geom_density(aes(x=`2002`, fill="2002"), alpha=0.2)+
geom_density(aes(x=`2003`, fill="2003"), alpha=0.2)+geom_density(aes(x=`2004`, fill="2004"), alpha=0.2)+
geom_density(aes(x=`2005`, fill="2005"), alpha=0.2)+geom_density(aes(x=`2006`, fill="2006"), alpha=0.2)+
geom_density(aes(x=`2007`, fill="2007"), alpha=0.2)+geom_density(aes(x=`2008`, fill="2008"), alpha=0.2)+
geom_density(aes(x=`2009`, fill="2009"), alpha=0.2)+geom_density(aes(x=`2010`, fill="2010"), alpha=0.2)+
geom_density(aes(x=`2011`, fill="2011"), alpha=0.2)+geom_density(aes(x=`2012`, fill="2012"), alpha=0.2)+
geom_density(aes(x=`2013`, fill="2013"), alpha=0.2)+geom_density(aes(x=`2014`, fill="2014"), alpha=0.2)
ggplot(dat)+geom_density(aes(x=`2001`, fill="2001"), alpha=0.4)+geom_density(aes(x=`2002`, fill="2002"), alpha=0.4)+
geom_density(aes(x=`2003`, fill="2003"), alpha=0.4)+geom_density(aes(x=`2004`, fill="2004"), alpha=0.4)+
geom_density(aes(x=`2005`, fill="2005"), alpha=0.4)+geom_density(aes(x=`2006`, fill="2006"), alpha=0.4)+
geom_density(aes(x=`2007`, fill="2007"), alpha=0.4)+geom_density(aes(x=`2008`, fill="2008"), alpha=0.4)+
geom_density(aes(x=`2009`, fill="2009"), alpha=0.4)+geom_density(aes(x=`2010`, fill="2010"), alpha=0.4)+
geom_density(aes(x=`2011`, fill="2011"), alpha=0.4)+geom_density(aes(x=`2012`, fill="2012"), alpha=0.4)+
geom_density(aes(x=`2013`, fill="2013"), alpha=0.4)+geom_density(aes(x=`2014`, fill="2014"), alpha=0.4)
ggplot(dat)+geom_density(aes(x=`2001`, fill="2001"), alpha=0.5)+
geom_density(aes(x=`2005`, fill="2005"), alpha=0.5)+
geom_density(aes(x=`2009`, fill="2009"), alpha=0.5)+
geom_density(aes(x=`2014`, fill="2014"), alpha=0.5)+
scale_fill_manual(name="Year")+
labs(x="Age", y="Density", title="Change in Age Distribution accross Years")
ggplot(dat)+geom_density(aes(x=`2001`, fill="2001"), alpha=0.5)+
geom_density(aes(x=`2005`, fill="2005"), alpha=0.5)+
geom_density(aes(x=`2009`, fill="2009"), alpha=0.5)+
geom_density(aes(x=`2014`, fill="2014"), alpha=0.5)+
scale_fill_manual(name="Year")+
labs(x="Age", y="Density", title="Change in Age Distribution accross Years")
ggplot(dat)+geom_density(aes(x=`2001`, fill="2001"), alpha=0.5)+
geom_density(aes(x=`2005`, fill="2005"), alpha=0.5)+
geom_density(aes(x=`2009`, fill="2009"), alpha=0.5)+
geom_density(aes(x=`2014`, fill="2014"), alpha=0.5)+
scale_fill_manual(name="Year")+
labs(x="Age", y="Density", title="Change in Age Distribution accross Years")
ggplot(dat)+geom_density(aes(x=`2001`, fill="2001"), alpha=0.5)+
geom_density(aes(x=`2005`, fill="2005"), alpha=0.5)+
geom_density(aes(x=`2009`, fill="2009"), alpha=0.5)+
geom_density(aes(x=`2014`, fill="2014"), alpha=0.5)+
scale_fill_discrete(name="Year")+
labs(x="Age", y="Density", title="Change in Age Distribution accross Years")
ggplot(dat)+geom_density(aes(x=`2001`, fill="2001"), alpha=0.4)+geom_density(aes(x=`2002`, fill="2002"), alpha=0.4)+
geom_density(aes(x=`2003`, fill="2003"), alpha=0.4)+geom_density(aes(x=`2004`, fill="2004"), alpha=0.4)+
geom_density(aes(x=`2005`, fill="2005"), alpha=0.4)+geom_density(aes(x=`2006`, fill="2006"), alpha=0.4)+
geom_density(aes(x=`2007`, fill="2007"), alpha=0.4)+geom_density(aes(x=`2008`, fill="2008"), alpha=0.4)+
geom_density(aes(x=`2009`, fill="2009"), alpha=0.4)+geom_density(aes(x=`2010`, fill="2010"), alpha=0.4)+
geom_density(aes(x=`2011`, fill="2011"), alpha=0.4)+geom_density(aes(x=`2012`, fill="2012"), alpha=0.4)+
geom_density(aes(x=`2013`, fill="2013"), alpha=0.4)+geom_density(aes(x=`2014`, fill="2014"), alpha=0.4)
ggplot(dat)+geom_density(aes(x=`2001`, fill="2001"), alpha=0.4)+geom_density(aes(x=`2002`, fill="2002"), alpha=0.4)+
geom_density(aes(x=`2003`, fill="2003"), alpha=0.4)+geom_density(aes(x=`2004`, fill="2004"), alpha=0.4)+
geom_density(aes(x=`2005`, fill="2005"), alpha=0.4)+geom_density(aes(x=`2006`, fill="2006"), alpha=0.4)+
geom_density(aes(x=`2007`, fill="2007"), alpha=0.4)+geom_density(aes(x=`2008`, fill="2008"), alpha=0.4)+
geom_density(aes(x=`2009`, fill="2009"), alpha=0.4)+geom_density(aes(x=`2010`, fill="2010"), alpha=0.4)+
geom_density(aes(x=`2011`, fill="2011"), alpha=0.4)+geom_density(aes(x=`2012`, fill="2012"), alpha=0.4)+
geom_density(aes(x=`2013`, fill="2013"), alpha=0.4)+geom_density(aes(x=`2014`, fill="2014"), alpha=0.4)+
scale_fill_discrete(name="Year")+
labs(x="Age", y="Density", title="Change in Age Distribution accross Years")
#' @title Summary Statistics
#' @description Uses the age data from the read function and performs appropriate
#' analysis and generates graphics associated with the data.
#' @aliases stat
#' @aliases summary
#' @param type The kind of analysis to be done. The possible options are \code{summary}, \code{timeplot}.
#' @return Results from the kind of analysis specified by \code{type}.
#' @usage
#' statsummary(type)
#' @import ggplot2
#' @export
statsummary <- function(type){
#load all age data in list
age <- list("2001"=readBAyear("list_2001.txt", 2001, 2001, 1940)[,2], "2002"=readBAyear("list_2002.txt", 2002, 2002, 1940)[,2],"2003"=readBAyear("list_2003.txt", 2003, 2003, 1940)[,2],"2004"=readBAyear("list_2004.txt", 2004, 2004, 1940)[,2], "2005"=readBAyear("list_2005.txt", 2005, 2005, 1940)[,2],"2006"=readBAyear("list_2006.txt", 2006, 2006, 1940)[,2],"2007"=readBAyear("list_2007.txt", 2007, 2007, 1940)[,2], "2008"=readBAyear("list_2008.txt", 2008, 2008, 1940)[,2],"2009"=readBAyear("list_2009.txt", 2009, 2009, 1940)[,2],"2010"=readBAyear("list_2010.txt", 2010, 2010, 1940)[,2], "2011"=readBAyear("list_2011.txt", 2011, 2011, 1940)[,2],"2012"=readBAyear("list_2012.txt", 2012, 2011, 1940)[,2],"2013"=readBAyear("list_2013.txt", 2013, 2011, 1940)[,2],"2014"=readBAyear("list_2014.txt", 2014, 2011, 1940)[,2])
#Create matrix with the summary data
stat<-matrix(nrow=14, ncol=7)
for(i in 1:14){
for(j in 1:5){
stat[i,j] <- quantile(age[[i]])[j]
}
stat[i,6] <- mean(age[[i]])
stat[i,7] <- sd(age[[i]])
}
#Construct dataframe with all the summary information
output_1 <- data.frame(Year=2001:2014, Mean = stat[,6], SE = stat[,7], Minimum=stat[,1], Second = stat[,2], Median=stat[,3], Fourth=stat[,4], Maximum=stat[,5])
#Create dataframe with raw data
dat<-matrix(nrow=389, ncol=14)
for(i in 1:14){
dat[1:length(age[[i]]),i]<-age[[i]]
dat<-as.data.frame(dat)
names(dat)<-c("2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012","2013","2014")
}
if(type=="summary"){
print(output_1)
}
else if(type=="timeplot"){
#Construct a timeplot
ggplot(data = output_1)+geom_point(aes(x = Year, y = Mean, col="Mean"), size = 5, alpha=0.7)+
geom_smooth(aes(x = Year, y = Mean))+
geom_point(aes(x = Year, y = Second, col="Second Quartile"), alpha = 0.7, shape = 2)+
geom_point(aes(x = Year, y = Fourth, col= "Fourth Quartile"), alpha = 0.7, shape = 2)+
ylab("Age")+ggtitle("Timeplot of Mean, Second and Fourth Quantile of Ages")+
scale_color_discrete(name="Legend")
}
else if(type=="histogram"){
ggplot(dat, aes(x=`2014`))+geom_histogram(aes(y=..density..), binwidth = 4, fill = "orange", alpha = 0.7, col = "black")+
geom_density(alpha=0.4, fill="#FF6666")+labs(y = "Density", x = "Age", title = "Estimated Ages of Williams College Faculty in 2014")
}
else if(type=="fullhist"){
par(mfrow=c(3,4))
hist(dat$`2001`, main="2001",xlab="", ylab="")
hist(dat$`2002`, main="2002",xlab="", ylab="")
hist(dat$`2003`, main="2003",xlab="", ylab="")
hist(dat$`2004`, main="2004",xlab="", ylab="")
hist(dat$`2005`, main="2005",xlab="", ylab="Frequency of Ages")
hist(dat$`2006`, main="2006",xlab="", ylab="")
hist(dat$`2007`, main="2007",xlab="", ylab="")
hist(dat$`2008`, main="2008",xlab="", ylab="")
hist(dat$`2009`, main="2009",xlab="", ylab="")
hist(dat$`2010`, main="2010",xlab="Ages of Faculty", ylab="")
hist(dat$`2011`, main="2011",xlab="", ylab="")
hist(dat$`2012`, main="2012",xlab="", ylab="")
par(mfrow=c(1,1))
}
else if(type=="comparison"){
ggplot(dat)+geom_density(aes(x=`2001`, fill="2001"), alpha=0.5)+
geom_density(aes(x=`2005`, fill="2005"), alpha=0.5)+
geom_density(aes(x=`2009`, fill="2009"), alpha=0.5)+
geom_density(aes(x=`2014`, fill="2014"), alpha=0.5)+
scale_fill_discrete(name="Year")+
labs(x="Age", y="Density", title="Change in Age Distribution accross Years")
}
else if(type=="fullcomp"){
ggplot(dat)+geom_density(aes(x=`2001`, fill="2001"), alpha=0.4)+geom_density(aes(x=`2002`, fill="2002"), alpha=0.4)+
geom_density(aes(x=`2003`, fill="2003"), alpha=0.4)+geom_density(aes(x=`2004`, fill="2004"), alpha=0.4)+
geom_density(aes(x=`2005`, fill="2005"), alpha=0.4)+geom_density(aes(x=`2006`, fill="2006"), alpha=0.4)+
geom_density(aes(x=`2007`, fill="2007"), alpha=0.4)+geom_density(aes(x=`2008`, fill="2008"), alpha=0.4)+
geom_density(aes(x=`2009`, fill="2009"), alpha=0.4)+geom_density(aes(x=`2010`, fill="2010"), alpha=0.4)+
geom_density(aes(x=`2011`, fill="2011"), alpha=0.4)+geom_density(aes(x=`2012`, fill="2012"), alpha=0.4)+
geom_density(aes(x=`2013`, fill="2013"), alpha=0.4)+geom_density(aes(x=`2014`, fill="2014"), alpha=0.4)+
scale_fill_discrete(name="Year")+
labs(x="Age", y="Density", title="Change in Age Distribution accross Years")
}
}
statsummary("fullcomp")
statsummary("comparison")
statsummary("histogram")
statsummary("timeplot")
statsummary("fullhistogram")
statsummary("fullhist")
ggplot(dat)+geom_boxplot(aes(x=`2001`, fill="2001"), alpha=0.4)
ggplot(dat)+geom_boxplot(aes(x=`2001`), alpha=0.4)
ggplot(dat)+geom_boxplot(aes(y=`2001`))
ggplot(dat, aes(x=`2001`))+geom_boxplot()
warning("The specified type does not exist")
warning("The specified type does not exist. Enter ?statsummary or help(statsummary) to view all the options available.")
warning("The specified type does not exist. Enter ?statsummary or help(statsummary) to view all the options available.")
warning("The specified type does not exist. Enter ?statsummary or
help(statsummary) to view all the options available.")
statsummary("summary")
#' @title Summary Statistics
#' @description Uses the age data from the read function and performs appropriate
#' analysis and generates graphics associated with the data.
#' @aliases stat
#' @aliases summary
#' @param type The kind of analysis to be done. The possible options are \code{summary}, \code{timeplot}, \code{histogram}, \code{fullhist}, \code{comparison} and \code{fullcomp}.
#'    \code{summary} displays a 5 number summary of ages accross all years. \code{timeplot} displays the
#' @return Results from the kind of analysis specified by \code{type}.
#' @usage
#' statsummary(type)
#' @import ggplot2
#' @export
statsummary <- function(type){
#load all age data in list
age <- list("2001"=readBAyear("list_2001.txt", 2001, 2001, 1940)[,2], "2002"=readBAyear("list_2002.txt", 2002, 2002, 1940)[,2],"2003"=readBAyear("list_2003.txt", 2003, 2003, 1940)[,2],"2004"=readBAyear("list_2004.txt", 2004, 2004, 1940)[,2], "2005"=readBAyear("list_2005.txt", 2005, 2005, 1940)[,2],"2006"=readBAyear("list_2006.txt", 2006, 2006, 1940)[,2],"2007"=readBAyear("list_2007.txt", 2007, 2007, 1940)[,2], "2008"=readBAyear("list_2008.txt", 2008, 2008, 1940)[,2],"2009"=readBAyear("list_2009.txt", 2009, 2009, 1940)[,2],"2010"=readBAyear("list_2010.txt", 2010, 2010, 1940)[,2], "2011"=readBAyear("list_2011.txt", 2011, 2011, 1940)[,2],"2012"=readBAyear("list_2012.txt", 2012, 2011, 1940)[,2],"2013"=readBAyear("list_2013.txt", 2013, 2011, 1940)[,2],"2014"=readBAyear("list_2014.txt", 2014, 2011, 1940)[,2])
#Create matrix with the summary data
stat<-matrix(nrow=14, ncol=7)
for(i in 1:14){
for(j in 1:5){
stat[i,j] <- quantile(age[[i]])[j]
}
stat[i,6] <- mean(age[[i]])
stat[i,7] <- sd(age[[i]])
}
#Construct dataframe with all the summary information
output_1 <- data.frame(Year=2001:2014, Mean = stat[,6], SD = stat[,7], Minimum=stat[,1], Second = stat[,2], Median=stat[,3], Fourth=stat[,4], Maximum=stat[,5])
#Create dataframe with raw data
dat<-matrix(nrow=389, ncol=14)
for(i in 1:14){
dat[1:length(age[[i]]),i]<-age[[i]]
dat<-as.data.frame(dat)
names(dat)<-c("2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012","2013","2014")
}
if(type=="summary"){
print(output_1)
}
else if(type=="timeplot"){
#Construct a timeplot
ggplot(data = output_1)+geom_point(aes(x = Year, y = Mean, col="Mean"), size = 5, alpha=0.7)+
geom_smooth(aes(x = Year, y = Mean))+
geom_point(aes(x = Year, y = Second, col="Second Quartile"), alpha = 0.7, shape = 2)+
geom_point(aes(x = Year, y = Fourth, col= "Fourth Quartile"), alpha = 0.7, shape = 2)+
ylab("Age")+ggtitle("Timeplot of Mean, Second and Fourth Quantile of Ages")+
scale_color_discrete(name="Legend")
}
else if(type=="histogram"){
ggplot(dat, aes(x=`2014`))+geom_histogram(aes(y=..density..), binwidth = 4, fill = "orange", alpha = 0.7, col = "black")+
geom_density(alpha=0.4, fill="#FF6666")+labs(y = "Density", x = "Age", title = "Estimated Ages of Williams College Faculty in 2014")
}
else if(type=="fullhist"){
par(mfrow=c(3,4))
hist(dat$`2001`, main="2001",xlab="", ylab="")
hist(dat$`2002`, main="2002",xlab="", ylab="")
hist(dat$`2003`, main="2003",xlab="", ylab="")
hist(dat$`2004`, main="2004",xlab="", ylab="")
hist(dat$`2005`, main="2005",xlab="", ylab="Frequency of Ages")
hist(dat$`2006`, main="2006",xlab="", ylab="")
hist(dat$`2007`, main="2007",xlab="", ylab="")
hist(dat$`2008`, main="2008",xlab="", ylab="")
hist(dat$`2009`, main="2009",xlab="", ylab="")
hist(dat$`2010`, main="2010",xlab="Ages of Faculty", ylab="")
hist(dat$`2011`, main="2011",xlab="", ylab="")
hist(dat$`2012`, main="2012",xlab="", ylab="")
par(mfrow=c(1,1))
}
else if(type=="comparison"){
ggplot(dat)+geom_density(aes(x=`2001`, fill="2001"), alpha=0.5)+
geom_density(aes(x=`2005`, fill="2005"), alpha=0.5)+
geom_density(aes(x=`2009`, fill="2009"), alpha=0.5)+
geom_density(aes(x=`2014`, fill="2014"), alpha=0.5)+
scale_fill_discrete(name="Year")+
labs(x="Age", y="Density", title="Change in Age Distribution accross Years")
}
else if(type=="fullcomp"){
ggplot(dat)+geom_density(aes(x=`2001`, fill="2001"), alpha=0.4)+geom_density(aes(x=`2002`, fill="2002"), alpha=0.4)+
geom_density(aes(x=`2003`, fill="2003"), alpha=0.4)+geom_density(aes(x=`2004`, fill="2004"), alpha=0.4)+
geom_density(aes(x=`2005`, fill="2005"), alpha=0.4)+geom_density(aes(x=`2006`, fill="2006"), alpha=0.4)+
geom_density(aes(x=`2007`, fill="2007"), alpha=0.4)+geom_density(aes(x=`2008`, fill="2008"), alpha=0.4)+
geom_density(aes(x=`2009`, fill="2009"), alpha=0.4)+geom_density(aes(x=`2010`, fill="2010"), alpha=0.4)+
geom_density(aes(x=`2011`, fill="2011"), alpha=0.4)+geom_density(aes(x=`2012`, fill="2012"), alpha=0.4)+
geom_density(aes(x=`2013`, fill="2013"), alpha=0.4)+geom_density(aes(x=`2014`, fill="2014"), alpha=0.4)+
scale_fill_discrete(name="Year")+
labs(x="Age", y="Density", title="Change in Age Distribution accross Years")
}
else{
warning("The specified type does not exist. Enter ?statsummary or help(statsummary) to view all the options available.")
}
}
statsummary(df)
statsummary("df")
devtools::document()
library(facage)
rm(statsummary,mean)
library(facage)
library(facage)
View(average)
View(average)
rm(average,dat,stat,output_1)
rm(age)
rm(i,j)
statsummary("summary")
library(facage)
library(facage)
devtools::use_vignette()
devtools::use_vignette("facage")
library("RJournal")
install_packages("RJournal")
install_package("RJournal")
install.package("RJournal")
install.packages("RJournal")
library("facage")
readBAyear("list_2014", 2014, 2011, 1958)
readLines("list_2014")
readLines("list_2014.txt")
readLines("list_2014.txt")
readLines(system.file("extdata", dataset, package = "facage"), warn = FALSE)
readLines(system.file("extdata", "list_2014.txt", package = "facage"), warn = FALSE)
<<tidy=TRUE>>=
head(readLines(system.file("extdata", "list_2014.txt", package = "facage")
, warn = FALSE))
, warn = FALSE))[1:2])
, warn = FALSE))[1,2])
, warn = FALSE))[2])
strwrap((readLines(system.file("extdata", "list_2014.txt", package = "facage")
, warn = FALSE))[2])
strwrap((readLines(system.file("extdata", "list_2014.txt", package = "facage")
, warn = FALSE))[3])
strwrap((readLines(system.file("extdata", "list_2014.txt", package = "facage")
, warn = FALSE))[1:3])
gsub("[^[:digit:]]","",(readLines(system.file("extdata", "list_2014.txt",
package = "facage"), warn = FALSE))[1:3])
(readBAyear("list_2014.txt", 2014, 2011, 1958))[1:3]
(readBAyear("list_2014.txt", 2014, 2011, 1958))[1:3]
(readBAyear("list_2014.txt", 2014, 2011, 1958))[1:3,2]
(readBAyear("list_2014.txt", 2014, 2011, 1958))[1:3,1]
(readBAyear("list_2014.txt", 2014, 2011, 1958))[1:3,1:2]
(readBAyear("list_2014.txt", 2014, 2011, 1958))[1:3,]
head(readBAyear("list_2014.txt", 2014, 2011, 1958))
statsummary("summary")
head(statsummary("summary"))
(statsummary("summary"))[1:6,]
(statsummary("summary"))[1:2,]
library(facage)
(statsummary("summary"))[1:2,]
head(statsummary("summary"))
statsummary("histogram")
library(facage)
library(facage)
library(facage)
#' @title Read BA Year
setwd("~/Desktop")
library(facage)
devtools::load_all(".")
